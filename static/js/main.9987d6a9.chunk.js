(this.webpackJsonpaviasales=this.webpackJsonpaviasales||[]).push([[0],{26:function(e,t,c){},46:function(e,t,c){},47:function(e,t,c){},49:function(e,t,c){},50:function(e,t,c){},51:function(e,t,c){},52:function(e,t,c){},53:function(e,t,c){},54:function(e,t,c){},55:function(e,t,c){},56:function(e,t,c){"use strict";c.r(t);var n=c(2),s=c.n(n),a=c(21),r=c.n(a),i=(c(26),c(4)),l=c(3),o=c(6),j=c.n(o),u=c(11),d={ALL:"\u0432\u0441\u0435",DIRECT:"\u0431\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a",ONE_STOP:"1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430",TWO_STOPS:"2 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",THREE_STOPS:"3 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438"},O={PRICE:"\u0441\u0430\u043c\u044b\u0439 \u0434\u0435\u0448\u0435\u0432\u044b\u0439",DURATION:"\u0441\u0430\u043c\u044b\u0439 \u0431\u044b\u0441\u0442\u0440\u044b\u0439",OPTIMAL:"\u043e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439"},b=new Map([[d.ALL,-1],[d.DIRECT,0],[d.ONE_STOP,1],[d.TWO_STOPS,2],[d.THREE_STOPS,3]]),p=c(12),h=c.n(p),m=(c(46),c(47),c.p+"static/media/Logo.472c0451.svg"),x=c(0);function f(){return Object(x.jsx)("div",{className:"logo",children:Object(x.jsx)("img",{src:m,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0410\u0432\u0438\u0430\u0441\u0435\u0439\u043b\u0441"})})}c(49),c(50);function v(){return Object(x.jsx)("div",{className:"wrapper-loader",children:Object(x.jsx)("div",{className:"loader",children:"Loading..."})})}function g(e){var t=e.transferFilterOptions,c=e.changeCurrentTransferFilterOptions,n=e.isLoading,s=Object(l.a)(b.keys());return Object(x.jsxs)("div",{className:"transfer-filter",children:[Object(x.jsx)("h2",{className:"transfer-filter__title",children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"}),n&&Object(x.jsx)(v,{}),Object(x.jsx)("ul",{className:"transfer-options",children:s&&s.map((function(e){return Object(x.jsx)("li",{className:"transfer-options__option",children:Object(x.jsxs)("label",{children:[Object(x.jsx)("input",{type:"checkbox",className:"visually-hidden",checked:t.includes(e),onChange:function(){return function(e){switch(e){case d.ALL:t.includes(e)?c([]):c(s);break;default:t.includes(e)?c(Object(l.a)(t.filter((function(t){return t!==e&&t!==d.ALL})))):c([].concat(Object(l.a)(t),[e]).length===s.length-1?s:[].concat(Object(l.a)(t),[e]))}}(e)}}),Object(x.jsx)("span",{children:e})]})},e)}))})]})}c(51);function N(e){var t=e.currentSortOption,c=e.changeSortOption,n=e.isLoading;return Object(x.jsxs)("div",{className:"ticket-type-sort",children:[n&&Object(x.jsx)(v,{}),Object(x.jsx)("nav",{children:O&&Object.entries(O).map((function(e){var n=Object(i.a)(e,2),s=n[0],a=n[1];return Object(x.jsx)("button",{onClick:function(){c(a)},className:"type-btn".concat(t===a?" active":""),children:Object(x.jsx)("span",{children:a})},s)}))})]})}c(52);var k=function(e){return"".concat(e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")," \u0420")},T=function(e){var t=Math.floor(e/60),c=e%60;return"".concat(t>0?"".concat(t,"\u0447"):""," ").concat(c>0?"".concat(c,"\u043c"):"").trim()},S=function(e){return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},w=function(e,t){var c=new Date(e),n=new Date(c.getTime()+6e4*t);return S(n)},L=function(e,t){return e.duration+t.duration},y=function(e,t){return e.stops.length+t.stops.length},E=function(e,t,c){var n=function(e,t){if(t.includes(d.ALL))return e;var c=[];return t.forEach((function(t){var n=e.filter((function(e){return e.segments.every((function(e){return e.stops.length===b.get(t)}))}));c=[].concat(Object(l.a)(c),Object(l.a)(n))})),c}(e,c);switch(t){case O.PRICE:return function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.sort((function(e,c){return t?e.price-c.price:c.price-e.price}))}(n);case O.DURATION:return function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.sort((function(e,c){return t?e.segments.reduce(L)-c.segments.reduce(L):c.segments.reduce(L)-e.segments.reduce(L)}))}(n);default:return function(e){return e.sort((function(e,t){return e.segments.reduce(y)>t.segments.reduce(y)?1:e.segments.reduce(y)<t.segments.reduce(y)?-1:e.price>t.price?1:e.price<t.price?-1:0}))}(n)}};function P(e){var t=e.ticket,c=t.price,n=t.carrier,s=t.segments,a=function(e){var t=e.stops;switch(t.length){case 0:return"\u043f\u0440\u044f\u043c\u043e\u0439";case 1:return"".concat(t.length," \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430");case 2:case 3:case 4:return"".concat(t.length," \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438");case 5:default:return"".concat(t.length," \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a")}},r=function(e){var t=e.stops;return t.length>0?t.join(", "):"\u2014"};return Object(x.jsxs)("article",{className:"ticket",children:[Object(x.jsxs)("div",{className:"ticket-header",children:[Object(x.jsx)("p",{className:"price",children:k(c)}),Object(x.jsx)("img",{src:"https://pics.avs.io/110/36/".concat(n,".png"),className:"company-logo",alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0430\u0432\u0438\u0430\u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438 ".concat(n)})]}),s.map((function(e){return Object(x.jsxs)("div",{className:"ticket-details",children:[Object(x.jsxs)("div",{className:"details-header",children:[Object(x.jsxs)("p",{className:"route",children:[Object(x.jsx)("span",{children:e.origin})," - ",Object(x.jsx)("span",{children:e.destination})]}),Object(x.jsx)("p",{className:"duration",children:Object(x.jsx)("span",{children:"\u0432 \u043f\u0443\u0442\u0438"})}),Object(x.jsx)("p",{className:"stops",children:Object(x.jsx)("span",{children:a(e)})})]}),Object(x.jsxs)("div",{className:"details-info",children:[Object(x.jsxs)("p",{className:"route",children:[Object(x.jsx)("span",{children:S(e.date)})," \u2013 ",Object(x.jsx)("span",{children:w(e.date,e.duration)})]}),Object(x.jsx)("p",{className:"duration",children:Object(x.jsx)("span",{children:T(e.duration)})}),Object(x.jsx)("p",{className:"stops",children:Object(x.jsx)("span",{className:e.stops.length>0?"":"no-stops",children:r(e)})})]})]},"".concat(e.origin).concat(c).concat(n))}))]})}c(53),c(54);function A(){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(v,{}),Object(x.jsxs)("div",{className:"ticket-template",children:[Object(x.jsxs)("div",{className:"ticket-template-header",children:[Object(x.jsx)("div",{className:"ticket-template-price"}),Object(x.jsx)("div",{className:"ticket-template-logo"})]}),Object(x.jsxs)("div",{className:"ticket-template-details",children:[Object(x.jsx)("div",{className:"ticket-template-row",children:Object(x.jsxs)("div",{className:"ticket-template-header",children:[Object(x.jsxs)("div",{className:"wrapper",children:[Object(x.jsx)("div",{className:"route-header"}),Object(x.jsx)("div",{className:"route"})]}),Object(x.jsxs)("div",{className:"wrapper",children:[Object(x.jsx)("div",{className:"duration-header"}),Object(x.jsx)("div",{className:"duration"})]}),Object(x.jsxs)("div",{className:"wrapper",children:[Object(x.jsx)("div",{className:"stops-header"}),Object(x.jsx)("div",{className:"stops"})]})]})}),Object(x.jsx)("div",{className:"ticket-template-row",children:Object(x.jsxs)("div",{className:"ticket-template-header",children:[Object(x.jsxs)("div",{className:"wrapper",children:[Object(x.jsx)("div",{className:"route-header"}),Object(x.jsx)("div",{className:"route"})]}),Object(x.jsxs)("div",{className:"wrapper",children:[Object(x.jsx)("div",{className:"duration-header"}),Object(x.jsx)("div",{className:"duration"})]}),Object(x.jsxs)("div",{className:"wrapper",children:[Object(x.jsx)("div",{className:"stops-header"}),Object(x.jsx)("div",{className:"stops"})]})]})})]})]})]})}function I(e){var t=e.tickets,c=e.amountTodisplay,n=e.isLoading,s=t.slice(0,c);return Object(x.jsxs)("ul",{className:"ticket-list",children:[n&&Object(x.jsx)("li",{className:"ticket-item ticket-item-loading",children:Object(x.jsx)(A,{})}),!n&&s.length>0&&s.map((function(e){return Object(x.jsx)("li",{className:"ticket-item",children:Object(x.jsx)(P,{ticket:e})},"".concat(e.carrier,"-").concat(e.price))}))]})}c(55);function C(e){var t=e.changeDisplayTicketsAmount;return Object(x.jsx)("button",{className:"btn-more",onClick:function(){return t((function(e){return e+5}))},children:"\u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0451 ".concat(5," \u0431\u0438\u043b\u0435\u0442\u043e\u0432")})}var _=function(){var e=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),c=t[0],s=t[1],a=Object(n.useState)(!1),r=Object(i.a)(a,2),o=r[0],d=r[1],O=Object(n.useState)(null),b=Object(i.a)(O,2),p=b[0],m=b[1];return Object(n.useEffect)((function(){m(null),d(!0);var e=function(){var e=Object(u.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.get("https://front-test.beta.aviasales.ru/search");case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0.message),d(!1),m(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=Object(u.a)(j.a.mark((function e(c){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,d(!0),e.next=4,h.a.get("".concat("https://front-test.beta.aviasales.ru","/tickets?searchId=").concat(c));case 4:if(n=e.sent,s((function(e){return[].concat(Object(l.a)(e),Object(l.a)(n.data.tickets))})),n.data.stop){e.next=11;break}return e.next=9,t(c);case 9:e.next=12;break;case 11:d(!1);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),setTimeout((function(){t(c)}),1e3);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}();e().then((function(e){var c=e.data;return t(c.searchId)}))}),[]),{tickets:c,isPending:o,error:p}}(),t=e.tickets,c=e.isPending,s=e.error,a=Object(n.useState)(Object.values(d)),r=Object(i.a)(a,2),o=r[0],b=r[1],p=Object(n.useState)(O.PRICE),m=Object(i.a)(p,2),v=m[0],k=m[1],T=Object(n.useState)(5),S=Object(i.a)(T,2),w=S[0],L=S[1];return Object(x.jsxs)("div",{className:"App",children:[Object(x.jsx)(f,{}),Object(x.jsx)("h1",{className:"visually-hidden",children:"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043f\u043e\u0438\u0441\u043a\u0430 \u0434\u0435\u0448\u0435\u0432\u044b\u0445 \u0430\u0432\u0438\u0430\u0431\u0438\u043b\u0435\u0442\u043e\u0432"}),Object(x.jsxs)("div",{className:"outer-container",children:[Object(x.jsx)(g,{transferFilterOptions:o,changeCurrentTransferFilterOptions:b,isLoading:c}),Object(x.jsxs)("div",{className:"inner-container",children:[Object(x.jsx)(N,{currentSortOption:v,changeSortOption:k,isLoading:c}),s&&Object(x.jsx)("p",{children:s}),t&&Object(x.jsx)(I,{tickets:E(t,v,o),amountTodisplay:w,isLoading:c}),!c&&t&&t.length>5&&Object(x.jsx)(C,{changeDisplayTicketsAmount:L})]})]})]})};r.a.render(Object(x.jsx)(s.a.StrictMode,{children:Object(x.jsx)(_,{})}),document.getElementById("root"))}},[[56,1,2]]]);
//# sourceMappingURL=main.9987d6a9.chunk.js.map